!function(e,t,r){var n,l,i,o;i={data:[],animationSpeed:400,folderTrigger:"click",hideFiles:!1,fileContainer:null,nodeName:"name",nodeTitle:"name"},n=function(){function t(t,r){this.element=t,this.settings=e.extend({},i,r),this._defaults=i,this.init()}return t.prototype.init=function(){var t,n;return t=e(this.element),n=this.settings.data,e.isArray(n)&&n.length>0?("ul"===t.prop("tagName").toLowerCase()?t.addClass("filetree"):t=e(r.createElement("ul")).addClass("filetree").appendTo(t),this._createTree.call(this,t,n)):("ul"===t.prop("tagName").toLowerCase()?t.addClass("filetree"):t=t.find("ul").eq(0).addClass("filetree"),this._parseTree.call(this,t)),this._addListeners(),t},t.prototype.open=function(e){return this._openFolder(e)},t.prototype.close=function(e){return this._closeFolder(e)},t.prototype.toggle=function(t){var r;return r=e(t).closest("li"),r.hasClass("collapsed")?this._openFolder(t):r.hasClass("expanded")?this._closeFolder(t):void 0},t.prototype._createTree=function(t,n){var l,i,o,s,a,d,c,f,p,h,u,g,m,C,v,y;for(l=e(t),h=[],u=[],g=0,C=n.length;C>g;g++)s=n[g],"folder"===s.type&&u.push(s),"file"===s.type&&h.push(s);for(h.sort(this._nameSort),u.sort(this._nameSort),n=u.concat(h),f="ul"===l.prop("tagName").toLowerCase()?l:e(r.createElement("ul")),m=0,v=n.length;v>m;m++){a=n[m],c=e(r.createElement("li")).addClass(a.type),"file"===a.type&&this.settings.hideFiles===!0&&c.addClass("hidden"),i=e(r.createElement("a")).attr("href","#").attr("title",a[this.settings.nodeTitle]).html(a[this.settings.nodeName]);for(d in a)p=a[d],a.hasOwnProperty(d)&&"children"!==d&&i.data(d,p);c.append(i),f.append(c),"folder"===a.type&&"undefined"!=typeof a.children&&a.children.length>0&&(c.addClass("collapsed").addClass("has-children"),o=e(r.createElement("button")).addClass("arrow"),c.prepend(o),this.settings.hideFiles===!0&&(y=e.grep(a.children,function(e){return"folder"===e.type}),y.length>0&&(c.removeClass("collapsed").removeClass("has-children"),c.find("button").removeClass("arrow").addClass("no-arrow"))),this._createTree.call(this,c,a.children))}return l.append(f)},t.prototype._openFolder=function(t){var r,n,l,i,o,s;return n=e(t).closest("li"),n.hasClass("folder")?(r=n.find("a").eq(0),l=n.find("ul").eq(0),s=this,o=e.Event("open.folder.filetree"),i=e.Event("opened.folder.filetree"),r.trigger(o),l.slideDown(s.settings.animationSpeed,function(){return n.removeClass("collapsed").addClass("expanded"),l.removeAttr("style"),r.trigger(i)}),!1):!1},t.prototype._closeFolder=function(t){var r,n,l,i,o,s;return n=e(t).closest("li"),n.hasClass("folder")?(r=n.find("a").eq(0),l=n.find("ul").eq(0),s=this,o=e.Event("close.folder.filetree"),i=e.Event("closed.folder.filetree"),r.trigger(o),l.slideUp(s.settings.animationSpeed,function(){return n.removeClass("expanded").addClass("collapsed"),l.removeAttr("style"),r.trigger(i)}),!1):!1},t.prototype._clickFolder=function(t){var r,n,l;return r=e(t),n=r.closest("li"),l=e.Event("click.folder.filetree",{bubbles:!1}),r.trigger(l),!1},t.prototype._clickFile=function(t){var r,n,l;return r=e(t),n=r.closest("li"),l=e.Event("click.file.filetree",{bubbles:!1}),r.trigger(l),!1},t.prototype._addListeners=function(){var t,r;t=e(this.element),r=this,t.on("click","li.folder.collapsed.has-children > button.arrow",function(){return r._openFolder(this)}),t.on("click","li.folder.expanded.has-children > button.arrow",function(){return r._closeFolder(this)}),t.on("click","li.folder > a",function(){return r._clickFolder(this)}),t.on("click","li.file > a",function(){return r._clickFile(this)}),t.on("click","li.folder, li.file",function(){return!1})},t.prototype._parseTree=function(t){var r,n,l,i,o,s;for(r=e(t),i=r.find("> li"),o=0,s=i.length;s>o;o++)l=i[o],n=e(l).children(),n.length>0?e(l).addClass("folder").contents().filter(function(){return 3===this.nodeType}).wrap('<a href="#"></a>').end():e(l).addClass("file").wrapInner('<a href="#"></a>')},t.prototype._nameSort=function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0},t}(),l=function(t,r){return this.each(function(){var l,i;return l=e(this),i=l.data("$.filetree"),i||l.data("$.filetree",i=new n(this,t)),"string"==typeof t?i[t].call(i,r):void 0})},o=e.fn.filetree,e.fn.filetree=l,e.fn.filetree.Constructor=n,e.fn.filetree.noConflict=function(){return e.fn.filetree=o,this}}(jQuery,window,document);