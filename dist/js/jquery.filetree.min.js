!function(e,t,n){var i,r,o,l;o={data:[],animationSpeed:400,folderTrigger:"click",hideFiles:!1,fileContainer:null,nodeName:"name",nodeTitle:"name"},i=function(){function t(t,n){this.element=t,this.settings=e.extend({},o,n),this._defaults=o,this.init()}return t.prototype.init=function(){var t;t=this.settings.data,this._createTree.call(this,this.element,t),e(this.element).addClass("filetree"),this._addListeners()},t.prototype.open=function(){console.log(this.element)},t.prototype._createTree=function(t,i){var r,o,l,a,s,d,f,c,p,h,u,m,g,C,v,y;for(r=e(t),h=[],u=[],m=0,C=i.length;C>m;m++)a=i[m],"folder"===a.type&&u.push(a),"file"===a.type&&h.push(a);for(h.sort(this._nameSort),u.sort(this._nameSort),i=u.concat(h),c="ul"===r.prop("tagName").toLowerCase()?r:e(n.createElement("ul")),g=0,v=i.length;v>g;g++){s=i[g],f=e(n.createElement("li")).addClass(s.type),"file"===s.type&&this.settings.hideFiles===!0&&f.addClass("hidden"),o=e(n.createElement("a")).attr("href","#").attr("title",s[this.settings.nodeTitle]).html(s[this.settings.nodeName]);for(d in s)p=s[d],s.hasOwnProperty(d)&&"children"!==d&&o.data(d,p);f.append(o),c.append(f),"folder"===s.type&&"undefined"!=typeof s.children&&s.children.length>0&&(f.addClass("collapsed").addClass("has-children"),l=e(n.createElement("button")).addClass("arrow"),f.prepend(l),this.settings.hideFiles===!0&&(y=e.grep(s.children,function(e){return"folder"===e.type}),y.length>0&&(f.removeClass("collapsed").removeClass("has-children"),f.find("button").removeClass("arrow").addClass("no-arrow"))),this._createTree.call(this,f,s.children))}r.append(c)},t.prototype._openFolder=function(t){var n,i,r,o,l;return n=e(t).parent("li"),o=this,r=e.Event("open.folder.filetree"),i=e.Event("opened.folder.filetree"),l=n.find("ul").eq(0),n.find("a").eq(0).trigger(r),l.slideDown(o.settings.animationSpeed,function(){n.removeClass("collapsed").addClass("expanded"),l.removeAttr("style"),n.find("a").eq(0).trigger(i)}),!1},t.prototype._closeFolder=function(t){var n,i,r,o,l;return n=e(t).parent("li"),o=this,r=e.Event("close.folder.filetree"),i=e.Event("closed.folder.filetree"),l=n.find("ul").eq(0),n.find("a").eq(0).trigger(r),l.slideUp(o.settings.animationSpeed,function(){n.removeClass("expanded").addClass("collapsed"),l.removeAttr("style"),n.find("a").eq(0).trigger(i)}),!1},t.prototype._addListeners=function(){var t,n;t=e(this.element),n=this,t.on("click","li.folder.collapsed.has-children > button.arrow",function(){return n._openFolder(this)}),t.on("click","li.folder.expanded.has-children > button.arrow",function(){return n._closeFolder(this)}),t.on("click","li.folder > a",function(t){return e(this).triggerHandler("click.folder.filetree"),t.stopImmediatePropagation()}),t.on("click","li.file > a",function(t){return e(this).triggerHandler("click.file.filtree"),t.stopImmediatePropagation()}),t.on("click","li.folder, li.file",function(){})},t.prototype._nameSort=function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0},t}(),r=function(t){return this.each(function(){var n,r;return n=e(this),r=n.data("$.filetree"),r||n.data("$.filetree",r=new i(this,t)),"string"==typeof t?r[t].call(n):void 0})},l=e.fn.filetree,e.fn.filetree=r,e.fn.filetree.Constructor=i,e.fn.filetree.noConflict=function(){return e.fn.filetree=l,this}}(jQuery,window,document);