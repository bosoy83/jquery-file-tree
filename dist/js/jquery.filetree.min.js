!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){var t,r,l,n;l={data:[],animationSpeed:400,folderTrigger:"click",hideFiles:!1,fileContainer:null,nodeName:"name",nodeTitle:"name"},t=function(){function t(t,r){this.element=t,this.settings=e.extend({},l,r),this._defaults=l,this.init()}return t.prototype.init=function(){var t,r;return t=e(this.element),r=this.settings.data,e.isArray(r)&&r.length>0?("ul"===t.prop("tagName").toLowerCase()?t.addClass("filetree"):t=e(document.createElement("ul")).addClass("filetree").appendTo(t),this._createTree.call(this,t,r)):("ul"===t.prop("tagName").toLowerCase()?t.addClass("filetree"):t=t.find("ul").eq(0).addClass("filetree"),this._parseTree.call(this,t)),this._addListeners(),t},t.prototype.open=function(e){return this._openFolder(e)},t.prototype.close=function(e){return this._closeFolder(e)},t.prototype.toggle=function(t){var r;return r=e(t).closest("li"),r.hasClass("collapsed")?this._openFolder(t):r.hasClass("expanded")?this._closeFolder(t):void 0},t.prototype.select=function(t){return e(this.element).find("li.selected").removeClass("selected"),e(t).closest("li").addClass("selected")},t.prototype.destroy=function(){return e(this.element).off().empty()},t.prototype._createTree=function(t,r){var l,n,i,o,s,a,d,c,f,u,p,h,m,g,C,v;for(l=e(t),u=[],p=[],h=0,g=r.length;g>h;h++)o=r[h],"folder"===o.type&&p.push(o),"file"===o.type&&u.push(o);for(u.sort(this._nameSort),p.sort(this._nameSort),r=p.concat(u),c="ul"===l.prop("tagName").toLowerCase()?l:e(document.createElement("ul")),m=0,C=r.length;C>m;m++){s=r[m],d=e(document.createElement("li")).addClass(s.type),"file"===s.type&&this.settings.hideFiles===!0&&d.addClass("hidden"),n=e(document.createElement("a")).attr("href","#").attr("title",s[this.settings.nodeTitle]).html(s[this.settings.nodeName]);for(a in s)f=s[a],s.hasOwnProperty(a)&&"children"!==a&&n.data(a,f);d.append(n),c.append(d),"folder"===s.type&&"undefined"!=typeof s.children&&s.children.length>0&&(d.addClass("collapsed").addClass("has-children"),i=e(document.createElement("button")).addClass("arrow"),d.prepend(i),this.settings.hideFiles===!0&&(v=e.grep(s.children,function(e){return"folder"===e.type}),v.length>0&&(d.removeClass("collapsed").removeClass("has-children"),d.find("button").removeClass("arrow").addClass("no-arrow"))),this._createTree.call(this,d,s.children))}return l.append(c)},t.prototype._openFolder=function(t){var r,l,n,i,o,s;return l=e(t).closest("li"),l.hasClass("folder")?(r=l.find("a").eq(0),n=l.find("ul").eq(0),s=this,o=e.Event("open.folder.filetree"),i=e.Event("opened.folder.filetree"),r.trigger(o),n.slideDown(s.settings.animationSpeed,function(){return l.removeClass("collapsed").addClass("expanded"),n.removeAttr("style"),r.trigger(i)}),!1):!1},t.prototype._closeFolder=function(t){var r,l,n,i,o,s;return l=e(t).closest("li"),l.hasClass("folder")?(r=l.find("a").eq(0),n=l.find("ul").eq(0),s=this,o=e.Event("close.folder.filetree"),i=e.Event("closed.folder.filetree"),r.trigger(o),n.slideUp(s.settings.animationSpeed,function(){return l.removeClass("expanded").addClass("collapsed"),n.removeAttr("style"),r.trigger(i)}),!1):!1},t.prototype._clickFolder=function(t){var r,l,n;return r=e(t),l=r.closest("li"),n=e.Event("click.folder.filetree",{bubbles:!1}),r.trigger(n),!1},t.prototype._clickFile=function(t){var r,l,n;return r=e(t),l=r.closest("li"),n=e.Event("click.file.filetree",{bubbles:!1}),r.trigger(n),!1},t.prototype._addListeners=function(){var t,r;t=e(this.element),r=this,t.on("click","li.folder.collapsed.has-children > button.arrow",function(){return r._openFolder(this)}),t.on("click","li.folder.expanded.has-children > button.arrow",function(){return r._closeFolder(this)}),t.on("click","li.folder > a",function(){return r._clickFolder(this)}),t.on("click","li.file > a",function(){return r._clickFile(this)}),t.on("dblclick","li.folder > a",function(){var t,r;return t=e(this),r=e.Event("dblclick.folder.filetree",{bubbles:!1}),t.trigger(r)}),t.on("dblclick","li.file > a",function(){var t,r;return t=e(this),r=e.Event("dblclick.file.filetree",{bubbles:!1}),t.trigger(r)}),t.on("click dblclick","li.folder, li.file",function(){return!1})},t.prototype._parseTree=function(t){var r,l,n,i,o,s,a,d,c,f,u;for(r=e(t),o=r.find("> li"),d=0,f=o.length;f>d;d++)if(i=o[d],a=e(i).find("> ul"),n=e(a).find("> li"),n.length>0)for(l=e(document.createElement("button")).addClass("arrow"),e(i).addClass("folder has-children collapsed").prepend(l),c=0,u=a.length;u>c;c++)s=a[c],this._parseTree(s);else e(i).addClass("file");return r.find("li > a[data-type=folder]").closest("li").addClass("folder").removeClass("file")},t.prototype._nameSort=function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0},t}(),r=function(r,l){return this.each(function(){var n,i;return n=e(this),i=n.data("$.filetree"),i||n.data("$.filetree",i=new t(this,r)),"string"==typeof r&&"_"!==r.substr(0,1)?i[r].call(i,l):void 0})},n=e.fn.filetree,e.fn.filetree=r,e.fn.filetree.Constructor=t,e.fn.filetree.noConflict=function(){return e.fn.filetree=n,this}});